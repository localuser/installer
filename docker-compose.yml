nginx:
  image: nginx:stable-alpine
  restart: always
  ports:
    - "80:80"
  volumes:
    - ./etc/nginx/nginx.conf:/etc/nginx/nginx.conf
  links:
    - api-server
    - app-web
    - app-admin
    - app-desktop

api-server:
  image: 847166803921.dkr.ecr.us-east-1.amazonaws.com/staff-api-server:latest
  links:
   - mongo
   - rabbitmq
  ports:
   - "80:80"
  environment:
   PORT: 80
   MONGO_URI: mongodb://mongo/staffdotcom'
   RABBIT_URI: amqp://rabbitmq
   API_URL: "http://api.staff.local"
   NODE_ENV: production

app-web:
  image: 847166803921.dkr.ecr.us-east-1.amazonaws.com/staff-app-web:latest
  ports:
   - "4000:3000"
  environment:
   API_URL: "http://api.staff.local"
   NODE_ENV: production

app-admin:
  image: 847166803921.dkr.ecr.us-east-1.amazonaws.com/staff-app-admin:latest
  ports:
   - "5000:3000"
  environment:
   API_URL: "http://api.staff.local"
   NODE_ENV: production

app-desktop:
  image: 847166803921.dkr.ecr.us-east-1.amazonaws.com/staff-app-desktop:latest
  ports:
   - "6000:3000"
  environment:
   API_URL: "http://api.staff.local"
   NODE_ENV: production

mongo:
  image: mongo

rabbitmq:
  image: rabbitmq
